<!DOCTYPE html>
<html lang="en-us" xml:lang="en-us">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 One-mode visualization | Network Visualization</title>
  <meta name="description" content="4 One-mode visualization | Network Visualization" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="4 One-mode visualization | Network Visualization" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_network_viz" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 One-mode visualization | Network Visualization" />
  
  
  

<meta name="author" content="Liza Wood" />


<meta name="date" content="2023-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-network-objects-in-r.html"/>
<link rel="next" href="two-mode-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Network visualization</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>0.1</b> Description</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>0.2</b> Learning goals</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>0.3</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-are-network-data"><i class="fa fa-check"></i><b>1.1</b> What are network data?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#features-of-a-network"><i class="fa fa-check"></i><b>1.1.1</b> Features of a network</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#network-statistics"><i class="fa fa-check"></i><b>1.1.2</b> Network statistics</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#storing-network-data"><i class="fa fa-check"></i><b>1.2</b> Storing network data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#delta-science-tracker"><i class="fa fa-check"></i><b>2.1</b> Delta Science Tracker</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#data-descriptions"><i class="fa fa-check"></i><b>2.2</b> Data descriptions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-network-objects-in-r.html"><a href="creating-network-objects-in-r.html"><i class="fa fa-check"></i><b>3</b> Creating network objects in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-network-objects-in-r.html"><a href="creating-network-objects-in-r.html#igraph"><i class="fa fa-check"></i><b>3.1</b> <code>igraph</code></a></li>
<li class="chapter" data-level="3.2" data-path="creating-network-objects-in-r.html"><a href="creating-network-objects-in-r.html#network"><i class="fa fa-check"></i><b>3.2</b> <code>network</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="creating-network-objects-in-r.html"><a href="creating-network-objects-in-r.html#preparing-to-work-with-network"><i class="fa fa-check"></i><b>3.2.1</b> Preparing to work with <code>network</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html"><i class="fa fa-check"></i><b>4</b> One-mode visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#guiding-questions"><i class="fa fa-check"></i><b>4.2</b> Guiding questions</a></li>
<li class="chapter" data-level="4.3" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#getting-started-with-ggraph"><i class="fa fa-check"></i><b>4.3</b> Getting started with <code>ggraph</code></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#layouts"><i class="fa fa-check"></i><b>4.3.1</b> Layouts</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#aesthetics-features"><i class="fa fa-check"></i><b>4.3.2</b> Aesthetics features</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#node-labels"><i class="fa fa-check"></i><b>4.3.3</b> Node labels</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#network-plotting-function"><i class="fa fa-check"></i><b>4.3.4</b> Network plotting function</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#removing-isolates"><i class="fa fa-check"></i><b>4.3.5</b> Removing isolates</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#longitudinal-networks"><i class="fa fa-check"></i><b>4.4</b> Longitudinal networks</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#faceting-edges"><i class="fa fa-check"></i><b>4.4.1</b> Faceting edges</a></li>
<li class="chapter" data-level="4.4.2" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#inducing-subgraphs-by-edge-attribute"><i class="fa fa-check"></i><b>4.4.2</b> Inducing subgraphs by edge attribute</a></li>
<li class="chapter" data-level="4.4.3" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#fixing-coordinates"><i class="fa fa-check"></i><b>4.4.3</b> Fixing coordinates</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#supplemental-material-community-detection"><i class="fa fa-check"></i><b>4.5</b> Supplemental Material: Community detection</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#algorithms-for-community-detection"><i class="fa fa-check"></i><b>4.5.1</b> Algorithms for community detection</a></li>
<li class="chapter" data-level="4.5.2" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#equivalence-clusters-block-models"><i class="fa fa-check"></i><b>4.5.2</b> Equivalence clusters &amp; block models</a></li>
<li class="chapter" data-level="4.5.3" data-path="one-mode-visualization.html"><a href="one-mode-visualization.html#plotting-block-membership"><i class="fa fa-check"></i><b>4.5.3</b> Plotting block membership</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html"><i class="fa fa-check"></i><b>5</b> Two-mode visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#making-two-mode-networks"><i class="fa fa-check"></i><b>5.1</b> Making two-mode networks:</a></li>
<li class="chapter" data-level="5.2" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#guiding-questions-1"><i class="fa fa-check"></i><b>5.2</b> Guiding questions:</a></li>
<li class="chapter" data-level="5.3" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#representing-two-mode-networks"><i class="fa fa-check"></i><b>5.3</b> Representing two-mode networks</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#the-one-mode-approach"><i class="fa fa-check"></i><b>5.3.1</b> The one-mode approach</a></li>
<li class="chapter" data-level="5.3.2" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#assign-top-labels-based-on-project-mode"><i class="fa fa-check"></i><b>5.3.2</b> Assign top labels based on project mode</a></li>
<li class="chapter" data-level="5.3.3" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#bipartite-layout"><i class="fa fa-check"></i><b>5.3.3</b> Bipartite layout</a></li>
<li class="chapter" data-level="5.3.4" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#functions"><i class="fa fa-check"></i><b>5.3.4</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#themed-projects"><i class="fa fa-check"></i><b>5.4</b> Themed projects</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="two-mode-visualization.html"><a href="two-mode-visualization.html#inducing-bipartite-network-by-nodes"><i class="fa fa-check"></i><b>5.4.1</b> Inducing bipartite network by nodes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.1" data-path="additional-resources.html"><a href="additional-resources.html#interactive-networks"><i class="fa fa-check"></i><b>6.1</b> Interactive networks</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="additional-resources.html"><a href="additional-resources.html#visnetwork"><i class="fa fa-check"></i><b>6.1.1</b> <code>visNetwork</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="additional-resources.html"><a href="additional-resources.html#networkd3"><i class="fa fa-check"></i><b>6.1.2</b> <code>networkD3</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="additional-resources.html"><a href="additional-resources.html#useful-tutorials"><i class="fa fa-check"></i><b>6.2</b> Useful tutorials</a></li>
<li class="chapter" data-level="6.3" data-path="additional-resources.html"><a href="additional-resources.html#other-plotting-packages"><i class="fa fa-check"></i><b>6.3</b> Other plotting packages</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="additional-resources.html"><a href="additional-resources.html#plot"><i class="fa fa-check"></i><b>6.3.1</b> <code>plot()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="additional-resources.html"><a href="additional-resources.html#ggallyggnet2"><i class="fa fa-check"></i><b>6.3.2</b> <code>GGally::ggnet2()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="additional-resources.html"><a href="additional-resources.html#ggnetworkggnetwork"><i class="fa fa-check"></i><b>6.3.3</b> <code>ggnetwork::ggnetwork()</code></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
  <img alt="CC BY-SA 4.0" src="https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg" style="float: right; padding-right: 10px;" />
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Network Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-mode-visualization" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> One-mode visualization<a href="one-mode-visualization.html#one-mode-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction<a href="one-mode-visualization.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we get started plotting <code>network</code> objects in <code>ggraph</code>, let’s also load in three more packages. The <code>sna</code> package provides us with several functions for calculating network statistics, and <code>dplyr</code> and <code>magrittr</code> are packages from that tidyverse that will help us streamline our plotting.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="one-mode-visualization.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb36-2"><a href="one-mode-visualization.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb36-3"><a href="one-mode-visualization.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code></pre></div>
</div>
<div id="guiding-questions" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Guiding questions<a href="one-mode-visualization.html#guiding-questions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As with any visualization, we need to have an idea of <a href="https://ucdavisdatalab.github.io/workshop_data_viz_principles/before-you-viz-make-a-plan.html">what stories we want to tell</a> / what questions we want to answer. Exploring visualizations without certain goals in mind is hard, and so throughout these plotting exercises we will have guiding questions that can keep us focused on what is important as we navigate the wide array of visualization options.</p>
<p>For our one-mode visualization we will focus on the following questions:</p>
<ol style="list-style-type: decimal">
<li>What organizations are most central to the collaborative research network in the Delta?</li>
<li>How have the Delta’s research collaborations changed over time?</li>
</ol>
</div>
<div id="getting-started-with-ggraph" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Getting started with <code>ggraph</code><a href="one-mode-visualization.html#getting-started-with-ggraph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this workshop we will use the <a href="https://cran.r-project.org/web/packages/ggraph/ggraph.pdf"><code>ggraph</code> package</a> (and function) for network visualization, created by Thomas Lin Pedersen, who also happens to make ‘generative’ artwork in R.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="img/winds2020.jpeg" alt="Thomas Lin Pedersen generative art with ggraph" width="75%" />
<p class="caption">
Figure 1.2: Thomas Lin Pedersen generative art with ggraph
</p>
</div>
<p><code>ggraph</code> relies on (and is a wrapper around) <code>ggplot2</code>, so it follows the same grammar of graphics approach. Let’s load in the <code>ggraph</code> package.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="one-mode-visualization.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span></code></pre></div>
<p>Just as in <code>ggplot</code>, <code>ggraph</code> has three core components:<br />
1. (network) data<br />
2. aesthetic mappings<br />
3. geometries (in this case edges and nodes)</p>
<p>We can combine the <code>ggraph()</code> function with a geometry specific to networks, <code>geom_node_point()</code>, to see the nodes as points. To connect these points, we can use an ‘edge link’ geometry, <code>geom_edge_link()</code>, which uses the network object’s built in x, y, (and xend, and yend) variables for the edge data.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="one-mode-visualization.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1) <span class="sc">+</span></span>
<span id="cb38-2"><a href="one-mode-visualization.html#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb38-3"><a href="one-mode-visualization.html#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>()</span></code></pre></div>
<pre><code>## Using &quot;stress&quot; as default layout</code></pre>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>What’s special here is that <code>ggraph</code> uses an algorithm to assign x and y mapping coordinates (more on that in a minute), so we don’t need to specify mapping arguments. You can check it out under the hood by looking at the object of the <code>ggraph</code> function:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="one-mode-visualization.html#cb40-1" aria-hidden="true" tabindex="-1"></a>ggraph_obj <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net1)</span>
<span id="cb40-2"><a href="one-mode-visualization.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ggraph_obj<span class="sc">$</span>data)</span></code></pre></div>
<pre><code>##          x          y circular mode    na
## 1 30.99909 0.05901063    FALSE    1 FALSE
## 2 35.15462 2.53947293    FALSE    1 FALSE
## 3 27.00000 0.00000000    FALSE    1 FALSE
## 4 33.21982 4.57659359    FALSE    1 FALSE
## 5  0.00000 0.00000000    FALSE    1 FALSE
## 6  1.00000 0.00000000    FALSE    1 FALSE
##                                                  name
## 1 Agricultural Coalitions: Landowners membership fees
## 2                                          Anchor QEA
## 3                                Audubon Canyon Ranch
## 4                              Bachand and Associates
## 5                                                 BTS
## 6                                             CalFish
##                                                     url .ggraph.orig_index
## 1 https://sciencetracker.deltacouncil.ca.gov/node/49590                  1
## 2 https://sciencetracker.deltacouncil.ca.gov/node/49592                  2
## 3 https://sciencetracker.deltacouncil.ca.gov/node/49593                  3
## 4 https://sciencetracker.deltacouncil.ca.gov/node/49594                  4
## 5 https://sciencetracker.deltacouncil.ca.gov/node/49598                  5
## 6 https://sciencetracker.deltacouncil.ca.gov/node/49600                  6
##   .ggraph.index
## 1             1
## 2             2
## 3             3
## 4             4
## 5             5
## 6             6</code></pre>
<p>Just as in <code>ggplot</code>, we can use the <code>+</code> symbol to layer on plot features, such as themes. For example, the <code>theme_void()</code> can help us focus in on the network visualization itself.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="one-mode-visualization.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1) <span class="sc">+</span></span>
<span id="cb42-2"><a href="one-mode-visualization.html#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="one-mode-visualization.html#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="one-mode-visualization.html#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span></code></pre></div>
<pre><code>## Using &quot;stress&quot; as default layout</code></pre>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note how we are alerted that the node point geometry uses a default layout based on the ‘stress’ algorithm to assign its x and y coordinates for plotting the node points as we see above. So next we’ll talk about layout algorithms.</p>
<div id="layouts" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Layouts<a href="one-mode-visualization.html#layouts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Networks are typically laid out based on the algorithm you (or the package default) chooses. Layouts are a <em>choice</em> based on how you would like to present the network. Because networks are depicting actors and relationships in an two-dimensional space (x, y), there is no ‘right’ way to plot actors in space (unless, of course, you have actual spatial data associated with your nodes, in which case you could use a geospatial network mapping (e.g. <a href="https://www.igismap.com/flight-routes-network-analysis/">flight route maps</a>)).</p>
<p>For scenarios without geospatial coordinates, network theorists have developed layout algorithms which define rules for calculating the x and y coordinates of the nodes. Many layout algorithms aim to represent networks so that strongly connected nodes are plotted in close proximity to one another, representing a ‘core’ and a ‘periphery’.</p>
<p>There is an overview of <code>ggraph</code>‘s different layouts presented in this <a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/">blog post</a>, and descriptions of some of them in the <a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Layouts.html">ggraph vignette</a> and <a href="https://cran.r-project.org/web/packages/ggraph/ggraph.pdf">documentation</a>, under the <code>layout_tbl_graph_...</code> functions. The layout is selected with the ’layout’ argument within the <code>ggraph</code> function. Below we present our network with a few different layouts.</p>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-8-1.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-8-2.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-8-3.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-8-4.png" width="50%" /></p>
<p>Note that there is a whole world of plotting networks using <a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Nodes.html">different conceptualizations of nodes</a> and <a href="https://cran.r-project.org/web/packages/ggraph/vignettes/Edges.html">edges</a>. These conceptualizations of nodes and edges may be dependent on certain layout algorithms. For example, if working with a ‘tree’ based layout, which creates more of a hierarchical structure like a dendrogram, edges as lines may not be suited. Instead, you can specify different edges (e.g. diagonals).</p>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-9-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>For the sake of this workshop we are sticking to more ‘traditional’ network visualization, so we will only be depicting nodes as points and edges as lines.</p>
<p>You can also set a <strong>manual layout</strong>. Because layouts are just x and y coordinates of points defined by a certain algorithm, you can extract those coordinates using the <code>create_layout()</code> function from <code>ggraph</code>, and fix and/or manipulate those coordinates, if need be. We will deal with this more in the longitudinal networks section.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="one-mode-visualization.html#cb44-1" aria-hidden="true" tabindex="-1"></a>fixed_coord <span class="ot">&lt;-</span> <span class="fu">create_layout</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>)</span>
<span id="cb44-2"><a href="one-mode-visualization.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fixed_coord[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span>)])</span></code></pre></div>
<pre><code>##           x         y                                                name
## 1  8.198692  1.132870 Agricultural Coalitions: Landowners membership fees
## 2 -3.080826 -4.348381                                          Anchor QEA
## 3  6.105444  3.958132                                Audubon Canyon Ranch
## 4 -7.111141 -3.339689                              Bachand and Associates
## 5  2.125042  7.922726                                                 BTS
## 6 -8.154113  5.227501                                             CalFish</code></pre>
<p>For our one-mode networks, we are going to use the ‘fr’ layout, which is the Fruchterman and Reingold (force-directed algorithm). This is a choice that helps place higher-degree nodes in the center, and low-degree and isolate nodes on the periphery.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="one-mode-visualization.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb46-2"><a href="one-mode-visualization.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="one-mode-visualization.html#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="one-mode-visualization.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="aesthetics-features" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Aesthetics features<a href="one-mode-visualization.html#aesthetics-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we’ve chosen a layout, let’s start adding some aesthetic features. This process will look very much like aesthetic mapping in <code>ggplot2</code>: we can assign aesthetics like color, size, shape, etc., and these features can either be directly related to the data (i.e. data features) or more generic plot features.</p>
<p>As we build out the basics of the <code>ggraph</code> package, we’re going to focus on our first question: <em>What organizations are most central to the collaborative research network in the Delta?</em></p>
<p><strong>Size by degree</strong>: One common approach for network visualization is to size nodes by their degree centrality. While more central nodes are already placed at the center of our layout’s algorithm, it can be helpful to also increase their size to communicate this point by adding a data feature. To size by degree, we will want to create a degree variable as a node attribute using the <code>degree</code> function, and assign that attribute to our network data.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="one-mode-visualization.html#cb47-1" aria-hidden="true" tabindex="-1"></a>net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span> <span class="ot">&lt;-</span> <span class="fu">degree</span>(net1)</span></code></pre></div>
<p>Hint: if you get <code>Error in degree(net1) : Not a graph object</code>, double check that you have detached the <code>igraph</code> package!</p>
<p><strong>Color-blind friendly colors</strong>: We’d also like our nodes and edges to be colored differently than the default black, so we can set these colors to our geometries as a plot feature. Because the focus of these networks are on nodes, not edges, we can set our edges to a less pronounced color like grey, and select an <a href="https://ucdavisdatalab.github.io/workshop_data_viz_principles/accessible-data-visualizations.html">accessible, color-blind friendly color palette</a> to select a node color from. I personally like to use viridis:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="one-mode-visualization.html#cb48-1" aria-hidden="true" tabindex="-1"></a>viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">12</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;#440154FF&quot; &quot;#482173FF&quot; &quot;#433E85FF&quot; &quot;#38598CFF&quot; &quot;#2D708EFF&quot; &quot;#25858EFF&quot;
##  [7] &quot;#1E9B8AFF&quot; &quot;#2BB07FFF&quot; &quot;#51C56AFF&quot; &quot;#85D54AFF&quot; &quot;#C2DF23FF&quot; &quot;#FDE725FF&quot;</code></pre>
<p>The latest version of R studio lets us see these colors when we write them out in a script, so let’s do that, and assign these colors to an object named <code>clrs</code>. We will be referencing this vector as we start using the palette.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="one-mode-visualization.html#cb50-1" aria-hidden="true" tabindex="-1"></a>clrs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#440154FF&quot;</span>, <span class="st">&quot;#482173FF&quot;</span>, <span class="st">&quot;#433E85FF&quot;</span>, <span class="st">&quot;#38598CFF&quot;</span>,</span>
<span id="cb50-2"><a href="one-mode-visualization.html#cb50-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;#2D708EFF&quot;</span>, <span class="st">&quot;#25858EFF&quot;</span>, <span class="st">&quot;#1E9B8AFF&quot;</span>, <span class="st">&quot;#2BB07FFF&quot;</span>, </span>
<span id="cb50-3"><a href="one-mode-visualization.html#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;#51C56AFF&quot;</span>, <span class="st">&quot;#85D54AFF&quot;</span>, <span class="st">&quot;#C2DF23FF&quot;</span>, <span class="st">&quot;#FDE725FF&quot;</span>)</span></code></pre></div>
<p>We can now integrate these three features: node size, which is stored in our network data, as well as edge color and node color, which will be set without reference to the data.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="one-mode-visualization.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb51-2"><a href="one-mode-visualization.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), </span>
<span id="cb51-3"><a href="one-mode-visualization.html#cb51-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clrs[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb51-4"><a href="one-mode-visualization.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="one-mode-visualization.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice how layer order matters (as as with <code>ggplot2</code>), and so by having edges layered on top of nodes, we are really hiding the nodes. Let’s try to switch this, but also include some alpha arguments to help increase transparency.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="one-mode-visualization.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb52-2"><a href="one-mode-visualization.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-3"><a href="one-mode-visualization.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), </span>
<span id="cb52-4"><a href="one-mode-visualization.html#cb52-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> clrs[<span class="dv">4</span>], <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="one-mode-visualization.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<!----
Note: The approach we will take for this workshop is to assign attributes to the network data frame, then add them into our plotting aesthetics. There is also some [compatibility with tidyverse's graph package, tidygraph](https://cran.r-project.org/web/packages/ggraph/vignettes/tidygraph.html), which we could use to set network aesthetics directly in the plotting functions (below), but we will not really be exploring that today. 


```r
ggraph(net1, layout = 'fr') +
  geom_edge_link(color = "gray70") +
  geom_node_point(aes(size = tidygraph::centrality_degree()), 
                  color = clrs[4], alpha = .8) +
  theme_void()
```

<img src="04_onemode_visualization_files/figure-html/unnamed-chunk-17-1.png" width="672" />
---->
<p>We can also make thematic alterations such as adding a title label to the plot and removing the legend.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="one-mode-visualization.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb53-2"><a href="one-mode-visualization.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="one-mode-visualization.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), <span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb53-4"><a href="one-mode-visualization.html#cb53-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb53-5"><a href="one-mode-visualization.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb53-6"><a href="one-mode-visualization.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="one-mode-visualization.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" />
Notice that with the ‘fr’ layout (and any other layout algorithm), the coordinates change a bit every time. This is because each time we create a visualization the algorithm is re-run, and there is variation in the exact calculation. You can set your seed (every time before you plot) to keep it consistent.</p>
</div>
<div id="node-labels" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Node labels<a href="one-mode-visualization.html#node-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we are getting a clear shape of the network. But related to our first question we want to understand <em>who</em> is central to collaboration. To better identify our nodes, let’s try to add some node text with the <code>geom_node_text()</code> geometry. Already, we have a variable that is the name of our vertices:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="one-mode-visualization.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(net1 <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Agricultural Coalitions: Landowners membership fees&quot;
## [2] &quot;Anchor QEA&quot;                                         
## [3] &quot;Audubon Canyon Ranch&quot;                               
## [4] &quot;Bachand and Associates&quot;                             
## [5] &quot;BTS&quot;                                                
## [6] &quot;CalFish&quot;</code></pre>
<p>Let’s add this as a text geometry.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="one-mode-visualization.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb56-2"><a href="one-mode-visualization.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-3"><a href="one-mode-visualization.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), <span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb56-4"><a href="one-mode-visualization.html#cb56-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="one-mode-visualization.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="one-mode-visualization.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="one-mode-visualization.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="one-mode-visualization.html#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb56-9"><a href="one-mode-visualization.html#cb56-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb56-10"><a href="one-mode-visualization.html#cb56-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Okay, a bit overwhelming. Instead, let’s be selective based on degree. Let’s say we want to take the top 5-degree nodes and label them.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="one-mode-visualization.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the network&#39;s degree values based on the order of degrees</span></span>
<span id="cb57-2"><a href="one-mode-visualization.html#cb57-2" aria-hidden="true" tabindex="-1"></a>degs <span class="ot">&lt;-</span> (net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)[<span class="fu">order</span>(net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>, <span class="at">decreasing =</span> T)]</span>
<span id="cb57-3"><a href="one-mode-visualization.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Then identify the top 5 unique degree values</span></span>
<span id="cb57-4"><a href="one-mode-visualization.html#cb57-4" aria-hidden="true" tabindex="-1"></a>topdegs <span class="ot">&lt;-</span> <span class="fu">unique</span>(degs)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb57-5"><a href="one-mode-visualization.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then create a network variable named labels and add the name only if a</span></span>
<span id="cb57-6"><a href="one-mode-visualization.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># node has the number of degrees in the &#39;top degrees&#39;</span></span>
<span id="cb57-7"><a href="one-mode-visualization.html#cb57-7" aria-hidden="true" tabindex="-1"></a>net1 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>) <span class="sc">%in%</span> topdegs, </span>
<span id="cb57-8"><a href="one-mode-visualization.html#cb57-8" aria-hidden="true" tabindex="-1"></a>                           net1 <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span>, <span class="cn">NA</span>)</span></code></pre></div>
<p>Now we have a sparse label attribute.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="one-mode-visualization.html#cb58-1" aria-hidden="true" tabindex="-1"></a>net1 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span></span></code></pre></div>
<pre><code>##   [1] NA      NA      NA      NA      NA      NA      NA      &quot;CDFW&quot;  NA     
##  [10] NA      NA      NA      NA      NA      &quot;DWR&quot;   NA      NA      NA     
##  [19] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [28] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [37] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [46] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [55] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [64] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [73] NA      NA      NA      NA      NA      NA      NA      NA      NA     
##  [82] NA      &quot;SFEI&quot;  NA      NA      NA      NA      NA      NA      NA     
##  [91] NA      NA      NA      NA      NA      NA      NA      NA      NA     
## [100] NA      NA      &quot;USBR&quot;  NA      NA      NA      NA      NA      NA     
## [109] NA      NA      &quot;USFWS&quot; NA      &quot;USGS&quot;  NA      NA      NA      NA     
## [118] NA      NA      NA      NA      NA      NA      NA      NA      NA     
## [127] NA      NA      NA      NA      NA      NA      NA      NA      NA     
## [136] NA      NA      NA      NA</code></pre>
<p>We can use this labels attribute to make our figure more easily readable.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="one-mode-visualization.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb60-2"><a href="one-mode-visualization.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-3"><a href="one-mode-visualization.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), <span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb60-4"><a href="one-mode-visualization.html#cb60-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="one-mode-visualization.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href="one-mode-visualization.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="one-mode-visualization.html#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="one-mode-visualization.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb60-9"><a href="one-mode-visualization.html#cb60-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Almost. Let’s include a repel = T argument to make sure the text doesn’t overlap.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="one-mode-visualization.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb61-2"><a href="one-mode-visualization.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="one-mode-visualization.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), <span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb61-4"><a href="one-mode-visualization.html#cb61-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="one-mode-visualization.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb61-6"><a href="one-mode-visualization.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="one-mode-visualization.html#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-8"><a href="one-mode-visualization.html#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb61-9"><a href="one-mode-visualization.html#cb61-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb61-10"><a href="one-mode-visualization.html#cb61-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">repel =</span> T)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>So, <em>what organizations are most central to the collaborative research network in the Delta?</em> This network shows us the overall structure of collaboration, and we can use summary statistics to fill in the gaps. At the center of the network are three federal agencies, the <a href="https://sciencetracker.deltacouncil.ca.gov/node/49743">US Geological Survey (USGS)</a>, <a href="https://sciencetracker.deltacouncil.ca.gov/node/49741">US Fish and Wildlife Service (USFWS)</a>, and <a href="https://sciencetracker.deltacouncil.ca.gov/node/49731">US Bureau of Reclamation (USBR)</a>, two state agencies, <a href="https://sciencetracker.deltacouncil.ca.gov/node/49602">California Department of Fish and Wildlife (CDFW)</a> and <a href="https://sciencetracker.deltacouncil.ca.gov/node/49609">California Department of Water Resources (DWR)</a> one research institute, the <a href="https://sciencetracker.deltacouncil.ca.gov/node/49707">San Francisco Estuary Institute (SFEI)</a>.</p>
<p>Among the 139 organizations involved in scientific research in the Delta, there is a mean degree of 14, suggesting that organizations are involved with, on average, 14 other organizations (across one or more projects). The network is quite connected, as the main component includes 107 (77%) of the organizations, with 27 isolates, meaning that 27 organizations have not collaborated at all. Within that main component, the average path length is 2.3, meaning that on average an organization is less then 3 connections away from any other organization.</p>
<details>
<summary>
<strong>Bonus code:</strong> How to calculate network-level statistics with the <code>sna</code> package
</summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="one-mode-visualization.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">network.size</span>(net1)</span></code></pre></div>
<pre><code>## [1] 139</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="one-mode-visualization.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 13.66906</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="one-mode-visualization.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">component.largest</span>(net1))</span></code></pre></div>
<pre><code>## [1] 107</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="one-mode-visualization.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">isolates</span>(net1))</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="one-mode-visualization.html#cb70-1" aria-hidden="true" tabindex="-1"></a>main_comp <span class="ot">&lt;-</span> <span class="fu">component.largest</span>(net1, <span class="at">result =</span> <span class="st">&#39;graph&#39;</span>)</span>
<span id="cb70-2"><a href="one-mode-visualization.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">geodist</span>(main_comp)[[<span class="st">&#39;gdist&#39;</span>]], <span class="at">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] 2.345008</code></pre>
</details>
<p><br></p>
</div>
<div id="network-plotting-function" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Network plotting function<a href="one-mode-visualization.html#network-plotting-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we’ve got that down as a base, I want to define this network visualization approach as a function so that we can move through other material a little more smoothly. Feel free to just copy this function – all we are doing is taking the code we previously wrote, and replacing the network name that we’ve been using, net1, with the generic argument for the network name, ‘netname’.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="one-mode-visualization.html#cb72-1" aria-hidden="true" tabindex="-1"></a>netplot_function <span class="ot">&lt;-</span> <span class="cf">function</span>(netname){</span>
<span id="cb72-2"><a href="one-mode-visualization.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(netname, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb72-3"><a href="one-mode-visualization.html#cb72-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-4"><a href="one-mode-visualization.html#cb72-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree), <span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb72-5"><a href="one-mode-visualization.html#cb72-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="one-mode-visualization.html#cb72-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb72-7"><a href="one-mode-visualization.html#cb72-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="one-mode-visualization.html#cb72-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-9"><a href="one-mode-visualization.html#cb72-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb72-10"><a href="one-mode-visualization.html#cb72-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb72-11"><a href="one-mode-visualization.html#cb72-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">repel =</span> T)</span>
<span id="cb72-12"><a href="one-mode-visualization.html#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb72-13"><a href="one-mode-visualization.html#cb72-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="removing-isolates" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Removing isolates<a href="one-mode-visualization.html#removing-isolates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we move too far along in our formatting of this figure, we may want to remove isolates. There are certainly occasions where we <em>want</em> to see isolates in our network, but other times we are interested in the main component. We can identify our isolates with the <code>isolates</code> function and then induce our subgraph with only the non-isolate nodes using the <code>get.inducedSubgraph()</code> function.</p>
<p>The isolates function identified the numeric id of the node in a network, not associated with a particular network attribute.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="one-mode-visualization.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isolates</span>(net1)</span></code></pre></div>
<pre><code>##  [1]   5   6  10  14  16  18  26  33  37  42  46  50  56  58  69  76  77  79  97
## [20] 106 108 115 117 127 131 134 137</code></pre>
<p>As a result, we want to identify the ids of the network that are not isolates, which we can do by indexing the ids from the size of the network.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="one-mode-visualization.html#cb75-1" aria-hidden="true" tabindex="-1"></a>noiso <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">network.size</span>(net1))[<span class="sc">-</span><span class="fu">isolates</span>(net1)]</span>
<span id="cb75-2"><a href="one-mode-visualization.html#cb75-2" aria-hidden="true" tabindex="-1"></a>noiso</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   7   8   9  11  12  13  15  17  19  20  21  22  23  24
##  [19]  25  27  28  29  30  31  32  34  35  36  38  39  40  41  43  44  45  47
##  [37]  48  49  51  52  53  54  55  57  59  60  61  62  63  64  65  66  67  68
##  [55]  70  71  72  73  74  75  78  80  81  82  83  84  85  86  87  88  89  90
##  [73]  91  92  93  94  95  96  98  99 100 101 102 103 104 105 107 109 110 111
##  [91] 112 113 114 116 118 119 120 121 122 123 124 125 126 128 129 130 132 133
## [109] 135 136 138 139</code></pre>
<p>Then we use those to induce the subgraph with only certain vertices.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="one-mode-visualization.html#cb77-1" aria-hidden="true" tabindex="-1"></a>net1_noiso <span class="ot">&lt;-</span> <span class="fu">get.inducedSubgraph</span>(net1, <span class="at">v =</span> noiso)</span></code></pre></div>
<p>Now we can see our network without isolates, and quickly use our new <code>netplot_function</code>:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="one-mode-visualization.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_noiso)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="longitudinal-networks" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Longitudinal networks<a href="one-mode-visualization.html#longitudinal-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lets now turn to think more deeply about edges with the second guiding question: <em>How have the Delta’s research collaborations changed over time?</em> So far we’ve been looking at all of the research collaborations in the DST database, which range from 1950 to more or less present day. But remember that our data have edge attributes based on when the collaborative project occurred, binned into 4 time periods: Before 1980, 1980-1994, 1995-2009, and 2010-2024 (including ongoing projects).</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="one-mode-visualization.html#cb79-1" aria-hidden="true" tabindex="-1"></a>net1</span></code></pre></div>
<pre><code>##  Network attributes:
##   vertices = 139 
##   directed = FALSE 
##   hyper = FALSE 
##   loops = FALSE 
##   multiple = FALSE 
##   bipartite = FALSE 
##   total edges= 475 
##     missing edges= 0 
##     non-missing edges= 475 
## 
##  Vertex attribute names: 
##     degree labels mode name url vertex.names 
## 
##  Edge attribute names: 
##     before_1980 Y1980_1994 Y1995_2009 Y2010_2024</code></pre>
<div id="faceting-edges" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Faceting edges<a href="one-mode-visualization.html#faceting-edges" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One way to visualize subgraphs based on certain edge or node attributes is to use the <code>facet_edges</code> or <code>facet_nodes</code> functions in <code>ggraph</code>. Just like in <code>ggplot</code>, faceting can add another dimension to the data by breaking it out using certain categorical variables.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="one-mode-visualization.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_noiso) <span class="sc">+</span></span>
<span id="cb81-2"><a href="one-mode-visualization.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_edges</span>(<span class="sc">~</span>before_1980)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>This might be an worthwhile approach with different data and visualization goals, but with these data there are two drawbacks:</p>
<ol style="list-style-type: decimal">
<li>First and generally, faceting does not customize aesthetics such as degree size or label for each subgraph. It keeps the same degree size and assigned labels identified for the complete network, which misrepresents the connections in each subgraph.<br />
</li>
<li>Second for our data, we have ‘wide’ edge attributes, where each relationship in our data can occur across multiple time periods. That means given our current data structure, we can’t represent the collaborative relationships across time using faceting. One strategy to address this would be to restructure our edge list and create a new network. We aren’t going to go down this road but if you’re interested there is some bonus code below. Instead, we’re going to take a second strategy which is to manually induce each subgraph in order to better customize the plots.</li>
</ol>
<details>
<summary>
<strong>Bonus code:</strong> How to lengthen the edge list to create a weighted network and facet using a single edge attribute
</summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="one-mode-visualization.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lengthen the edge list</span></span>
<span id="cb82-2"><a href="one-mode-visualization.html#cb82-2" aria-hidden="true" tabindex="-1"></a>edges_1mode_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(edges_1mode,</span>
<span id="cb82-3"><a href="one-mode-visualization.html#cb82-3" aria-hidden="true" tabindex="-1"></a>                                        Y1995_2009<span class="sc">:</span>Y1980_1994,</span>
<span id="cb82-4"><a href="one-mode-visualization.html#cb82-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">names_to =</span> <span class="st">&quot;timeframe&quot;</span>,</span>
<span id="cb82-5"><a href="one-mode-visualization.html#cb82-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">values_to =</span> <span class="st">&quot;logical&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="one-mode-visualization.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(logical <span class="sc">==</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="one-mode-visualization.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>logical)</span>
<span id="cb82-8"><a href="one-mode-visualization.html#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="one-mode-visualization.html#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we create a network but with the long edges, but because the lengthening</span></span>
<span id="cb82-10"><a href="one-mode-visualization.html#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># process means we have multiple edges per pair, we need to set multiple = T</span></span>
<span id="cb82-11"><a href="one-mode-visualization.html#cb82-11" aria-hidden="true" tabindex="-1"></a>net1_long <span class="ot">&lt;-</span> <span class="fu">network</span>(<span class="at">x =</span> edges_1mode_long, </span>
<span id="cb82-12"><a href="one-mode-visualization.html#cb82-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">vertices =</span> nodes_1mode,</span>
<span id="cb82-13"><a href="one-mode-visualization.html#cb82-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bipartite =</span> F,  </span>
<span id="cb82-14"><a href="one-mode-visualization.html#cb82-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">directed =</span> F,</span>
<span id="cb82-15"><a href="one-mode-visualization.html#cb82-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">multiple =</span> T)</span>
<span id="cb82-16"><a href="one-mode-visualization.html#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can facet by our single time column, time frame; we&#39;ll remove the </span></span>
<span id="cb82-17"><a href="one-mode-visualization.html#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="co"># aesthetics that don&#39; carry over</span></span>
<span id="cb82-18"><a href="one-mode-visualization.html#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1_long, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb82-19"><a href="one-mode-visualization.html#cb82-19" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb82-20"><a href="one-mode-visualization.html#cb82-20" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_point</span>(<span class="at">color =</span> clrs[<span class="dv">4</span>],</span>
<span id="cb82-21"><a href="one-mode-visualization.html#cb82-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb82-22"><a href="one-mode-visualization.html#cb82-22" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb82-23"><a href="one-mode-visualization.html#cb82-23" aria-hidden="true" tabindex="-1"></a>         <span class="fu">facet_edges</span>(<span class="sc">~</span>timeframe)</span></code></pre></div>
<img src="04_onemode_visualization_files/figure-html/unnamed-chunk-33-1.png" width="672" />
</details>
</div>
<div id="inducing-subgraphs-by-edge-attribute" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Inducing subgraphs by edge attribute<a href="one-mode-visualization.html#inducing-subgraphs-by-edge-attribute" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To visualize how our networks change over time we are going to be ‘inducing subgraphs’, which is a network phrase for taking slices of our network. Networks can be induced based on certain nodes, which we just did in order to remove isolates. But for this question we will be making subgraphs based on edge attributes.</p>
<p>To induce our network based on edge attributes, we’ll want to identify which edges have those attributes. We can identify the edge ids for which each time category is equal to TRUE. We have these are four binary variables, rather than one attribute with four time categories, because organizations can collaborate on projects in more than one time period.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="one-mode-visualization.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let&#39;s give these ids, which will become important later</span></span>
<span id="cb83-2"><a href="one-mode-visualization.html#cb83-2" aria-hidden="true" tabindex="-1"></a>net1 <span class="sc">%v%</span> <span class="st">&#39;id&#39;</span> <span class="ot">&lt;-</span> net1 <span class="sc">%v%</span> <span class="st">&#39;vertex.names&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="one-mode-visualization.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the edges for each time period</span></span>
<span id="cb84-2"><a href="one-mode-visualization.html#cb84-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">which</span>(net1 <span class="sc">%e%</span> <span class="st">&#39;before_1980&#39;</span> <span class="sc">==</span> T)</span>
<span id="cb84-3"><a href="one-mode-visualization.html#cb84-3" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">which</span>(net1 <span class="sc">%e%</span> <span class="st">&#39;Y1980_1994&#39;</span> <span class="sc">==</span> T)</span>
<span id="cb84-4"><a href="one-mode-visualization.html#cb84-4" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">which</span>(net1 <span class="sc">%e%</span> <span class="st">&#39;Y1995_2009&#39;</span> <span class="sc">==</span> T)</span>
<span id="cb84-5"><a href="one-mode-visualization.html#cb84-5" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span> <span class="fu">which</span>(net1 <span class="sc">%e%</span> <span class="st">&#39;Y2010_2024&#39;</span> <span class="sc">==</span> T)</span>
<span id="cb84-6"><a href="one-mode-visualization.html#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the ids of their location in the network. For example:</span></span>
<span id="cb84-7"><a href="one-mode-visualization.html#cb84-7" aria-hidden="true" tabindex="-1"></a>t1</span></code></pre></div>
<pre><code>##   [1]   7  21  26  27  43  44  45  48  53  54  55  56  57  58  59  60  61  62
##  [19]  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80
##  [37]  81  82  83  84  85  86  87  88  89  90  91  92  93  94  96 101 102 103
##  [55] 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121
##  [73] 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139
##  [91] 141 155 156 157 158 159 160 161 162 168 169 170 171 172 173 174 175 176
## [109] 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194
## [127] 195 196 197 198 199 200 201 202 203 204 231 232 233 234 255 258 259 260
## [145] 261 262 267 268 269 270 271 290 353 354 355 356 357 358 359 360 361 362
## [163] 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380
## [181] 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398
## [199] 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416
## [217] 417 418 419 437</code></pre>
<p>Now that we have our edge ids for each time period (t1 through t4), we can use the <code>get.inducedSubgraph</code> function and identify the edge ids that we’d like to keep in each network.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="one-mode-visualization.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Induce subgraphs based on edges</span></span>
<span id="cb86-2"><a href="one-mode-visualization.html#cb86-2" aria-hidden="true" tabindex="-1"></a>net1_t1 <span class="ot">&lt;-</span> <span class="fu">get.inducedSubgraph</span>(net1, <span class="at">eid =</span> t1)</span>
<span id="cb86-3"><a href="one-mode-visualization.html#cb86-3" aria-hidden="true" tabindex="-1"></a>net1_t2 <span class="ot">&lt;-</span> <span class="fu">get.inducedSubgraph</span>(net1, <span class="at">eid =</span> t2)</span>
<span id="cb86-4"><a href="one-mode-visualization.html#cb86-4" aria-hidden="true" tabindex="-1"></a>net1_t3 <span class="ot">&lt;-</span> <span class="fu">get.inducedSubgraph</span>(net1, <span class="at">eid =</span> t3)</span>
<span id="cb86-5"><a href="one-mode-visualization.html#cb86-5" aria-hidden="true" tabindex="-1"></a>net1_t4 <span class="ot">&lt;-</span> <span class="fu">get.inducedSubgraph</span>(net1, <span class="at">eid =</span> t4)</span></code></pre></div>
<p>Now we have a slice of the network for each time period. Note that because we did not specify the vertex ids, these networks will include only the nodes that has connections for that time period, and it will not include isolates. For example, though our whole collaborative network has 139 nodes, the network from time period 2 has only 30.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="one-mode-visualization.html#cb87-1" aria-hidden="true" tabindex="-1"></a>net1_t2</span></code></pre></div>
<pre><code>##  Network attributes:
##   vertices = 30 
##   directed = FALSE 
##   hyper = FALSE 
##   loops = FALSE 
##   multiple = FALSE 
##   bipartite = FALSE 
##   total edges= 98 
##     missing edges= 0 
##     non-missing edges= 98 
## 
##  Vertex attribute names: 
##     degree id labels mode name url vertex.names 
## 
##  Edge attribute names: 
##     before_1980 Y1980_1994 Y1995_2009 Y2010_2024</code></pre>
<p>With these induced networks, an important thing to notice is that the attributes assigned in the complete network remain. This is is less important for exogenous, fixed attributes like name, but is important for endogenous/structural attributes like degree. For example, we can check the degree of SFEI in two different networks against the whole network and see that the degree attribute has carried over, but that calculation is no longer correct in the induced networks.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="one-mode-visualization.html#cb89-1" aria-hidden="true" tabindex="-1"></a>(net1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)[(net1 <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span> <span class="sc">==</span> <span class="st">&quot;SFEI&quot;</span>)]</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="one-mode-visualization.html#cb91-1" aria-hidden="true" tabindex="-1"></a>(net1_t1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)[(net1_t1 <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span> <span class="sc">==</span> <span class="st">&quot;SFEI&quot;</span>)]</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="one-mode-visualization.html#cb93-1" aria-hidden="true" tabindex="-1"></a>(net1_t2 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)[(net1_t2 <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span> <span class="sc">==</span> <span class="st">&quot;SFEI&quot;</span>)]</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<p>We need to update/reassign any structural values that we calculated for the whole network so that they are accurate for each sub-network.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="one-mode-visualization.html#cb95-1" aria-hidden="true" tabindex="-1"></a>net1_t1 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span> <span class="ot">&lt;-</span> <span class="fu">degree</span>(net1_t1)</span>
<span id="cb95-2"><a href="one-mode-visualization.html#cb95-2" aria-hidden="true" tabindex="-1"></a>net1_t2 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span> <span class="ot">&lt;-</span> <span class="fu">degree</span>(net1_t2)</span>
<span id="cb95-3"><a href="one-mode-visualization.html#cb95-3" aria-hidden="true" tabindex="-1"></a>net1_t3 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span> <span class="ot">&lt;-</span> <span class="fu">degree</span>(net1_t3)</span>
<span id="cb95-4"><a href="one-mode-visualization.html#cb95-4" aria-hidden="true" tabindex="-1"></a>net1_t4 <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span> <span class="ot">&lt;-</span> <span class="fu">degree</span>(net1_t4)</span></code></pre></div>
<p>Just as the degree attribute needed changed, we also need to change the the label attribute, which was assigned based on degree. We can write a function to do that to avoid repetition across each time period.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="one-mode-visualization.html#cb96-1" aria-hidden="true" tabindex="-1"></a>label_top_degree <span class="ot">&lt;-</span> <span class="cf">function</span>(netname, n){</span>
<span id="cb96-2"><a href="one-mode-visualization.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  degs <span class="ot">&lt;-</span> (netname <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>)[<span class="fu">order</span>(netname <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>, <span class="at">decreasing =</span> T)]</span>
<span id="cb96-3"><a href="one-mode-visualization.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  topdegs <span class="ot">&lt;-</span> <span class="fu">unique</span>(degs)[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb96-4"><a href="one-mode-visualization.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  labels <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((netname <span class="sc">%v%</span> <span class="st">&#39;degree&#39;</span>) <span class="sc">%in%</span> topdegs, </span>
<span id="cb96-5"><a href="one-mode-visualization.html#cb96-5" aria-hidden="true" tabindex="-1"></a>                           netname <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb96-6"><a href="one-mode-visualization.html#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(labels)</span>
<span id="cb96-7"><a href="one-mode-visualization.html#cb96-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we can apply that function to each subgraph, specifying that we want the top 5 names for each.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="one-mode-visualization.html#cb97-1" aria-hidden="true" tabindex="-1"></a>net1_t1 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span> <span class="ot">&lt;-</span> <span class="fu">label_top_degree</span>(net1_t1, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb97-2"><a href="one-mode-visualization.html#cb97-2" aria-hidden="true" tabindex="-1"></a>net1_t2 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span> <span class="ot">&lt;-</span> <span class="fu">label_top_degree</span>(net1_t2, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb97-3"><a href="one-mode-visualization.html#cb97-3" aria-hidden="true" tabindex="-1"></a>net1_t3 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span> <span class="ot">&lt;-</span> <span class="fu">label_top_degree</span>(net1_t3, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb97-4"><a href="one-mode-visualization.html#cb97-4" aria-hidden="true" tabindex="-1"></a>net1_t4 <span class="sc">%v%</span> <span class="st">&#39;labels&#39;</span> <span class="ot">&lt;-</span> <span class="fu">label_top_degree</span>(net1_t4, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Now that we’ve updated our attributes, let’s plot our subgraphs. We can use the <code>netplot_function</code> that we wrote in the Section 5.5 and layer on a title.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="one-mode-visualization.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_t1) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: Pre 1980&quot;</span>)</span>
<span id="cb98-2"><a href="one-mode-visualization.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_t2) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1980-1994&quot;</span>)</span>
<span id="cb98-3"><a href="one-mode-visualization.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_t3) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1995-2009&quot;</span>)</span>
<span id="cb98-4"><a href="one-mode-visualization.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(net1_t4) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 2010-2024&quot;</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-43-1.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-43-2.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-43-3.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-43-4.png" width="50%" />
This is a start, but the visualization challenge here is that it is hard to really detect change because the layout changes every time. Remember, our layout algorithm wants to cluster densely connected nodes, and because those clusters shift across time periods (combined with the random element in the algorithmic calculation itself), the algorithm will move nodes to a new coordinate in each time period. To improve this visualization, then, we want nodes to be in the same position for each subgraph. So next we learn how to fix the coordinates of the nodes across multiple graphs.</p>
</div>
<div id="fixing-coordinates" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Fixing coordinates<a href="one-mode-visualization.html#fixing-coordinates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>ggraph</code>, we can fix coordinates by creating a layout table from our initial network. Let’s all set the same seed so that we can have the same coordinates across computers. Note that we created an ‘id’ variable earlier based on the vertex name to serve as unique identifiers in these layout tables. We’ll do that again for out no isolates network</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="one-mode-visualization.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">26</span>)</span>
<span id="cb99-2"><a href="one-mode-visualization.html#cb99-2" aria-hidden="true" tabindex="-1"></a>net1_noiso <span class="sc">%v%</span> <span class="st">&#39;id&#39;</span> <span class="ot">&lt;-</span> net1_noiso <span class="sc">%v%</span> <span class="st">&#39;vertex.names&#39;</span></span>
<span id="cb99-3"><a href="one-mode-visualization.html#cb99-3" aria-hidden="true" tabindex="-1"></a>fixed_coord <span class="ot">&lt;-</span> <span class="fu">create_layout</span>(net1_noiso, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>)</span>
<span id="cb99-4"><a href="one-mode-visualization.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fixed_coord[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)])</span></code></pre></div>
<pre><code>##           x         y degree    id labels mode    na
## 1 -4.525570 -9.489269      2 49590   &lt;NA&gt;    1 FALSE
## 2 -3.393409 -1.165814     10 49592   &lt;NA&gt;    1 FALSE
## 3  6.230619 -4.040640      2 49593   &lt;NA&gt;    1 FALSE
## 4 -8.142122  1.745267      8 49594   &lt;NA&gt;    1 FALSE
## 5 -2.001708 -3.333115      6 49601   &lt;NA&gt;    1 FALSE
## 6 -2.796420  1.448559     88 49602   CDFW    1 FALSE
##                                                  name
## 1 Agricultural Coalitions: Landowners membership fees
## 2                                          Anchor QEA
## 3                                Audubon Canyon Ranch
## 4                              Bachand and Associates
## 5                                                 DOC
## 6                                                CDFW</code></pre>
<p>With these coordinates fixed from our full plot, we can then apply those same coordinates for each subgraph. To do that, we’ll first create manual layouts for each subgraph. Next we will subset the relevant coordinates from the full coordinate list using the node ‘id’.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="one-mode-visualization.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a layout table for the subgraph with &#39;fr&#39; coordinates</span></span>
<span id="cb101-2"><a href="one-mode-visualization.html#cb101-2" aria-hidden="true" tabindex="-1"></a>coord_t1 <span class="ot">&lt;-</span> <span class="fu">create_layout</span>(net1_t1, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>)</span>
<span id="cb101-3"><a href="one-mode-visualization.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Subset the relevant coordinates from the full layout table</span></span>
<span id="cb101-4"><a href="one-mode-visualization.html#cb101-4" aria-hidden="true" tabindex="-1"></a>fixed_coord_t1 <span class="ot">&lt;-</span> fixed_coord[fixed_coord<span class="sc">$</span>id <span class="sc">%in%</span> coord_t1<span class="sc">$</span>id, <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>,<span class="st">&#39;id&#39;</span>)]</span>
<span id="cb101-5"><a href="one-mode-visualization.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Overwrite the subgraph coordinates to match the fixed coordinated</span></span>
<span id="cb101-6"><a href="one-mode-visualization.html#cb101-6" aria-hidden="true" tabindex="-1"></a>coord_t1<span class="sc">$</span>x <span class="ot">&lt;-</span> fixed_coord_t1<span class="sc">$</span>x</span>
<span id="cb101-7"><a href="one-mode-visualization.html#cb101-7" aria-hidden="true" tabindex="-1"></a>coord_t1<span class="sc">$</span>y <span class="ot">&lt;-</span> fixed_coord_t1<span class="sc">$</span>y</span></code></pre></div>
<p>Instead of copying and pasting this over again, we’ll write a function to quickly assign the coordinates that we set as fixed to a given subgraph. To do that, we take the code we wrote above but generalize the network and fixed coordinate arguments to ‘netname’ and ‘fixed’. Then we can input any network name and any fixed coordinates, and set them all.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="one-mode-visualization.html#cb102-1" aria-hidden="true" tabindex="-1"></a>assign_fixed_coords <span class="ot">&lt;-</span> <span class="cf">function</span>(netname, fixed){</span>
<span id="cb102-2"><a href="one-mode-visualization.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  coord_t <span class="ot">&lt;-</span> <span class="fu">create_layout</span>(netname, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>)</span>
<span id="cb102-3"><a href="one-mode-visualization.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  fixed_coord_t <span class="ot">&lt;-</span> fixed[fixed<span class="sc">$</span>id <span class="sc">%in%</span> coord_t<span class="sc">$</span>id, <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)]</span>
<span id="cb102-4"><a href="one-mode-visualization.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  coord_t<span class="sc">$</span>x <span class="ot">&lt;-</span> fixed_coord_t<span class="sc">$</span>x</span>
<span id="cb102-5"><a href="one-mode-visualization.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  coord_t<span class="sc">$</span>y <span class="ot">&lt;-</span> fixed_coord_t<span class="sc">$</span>y</span>
<span id="cb102-6"><a href="one-mode-visualization.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(coord_t)</span>
<span id="cb102-7"><a href="one-mode-visualization.html#cb102-7" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="one-mode-visualization.html#cb103-1" aria-hidden="true" tabindex="-1"></a>coord_t1 <span class="ot">&lt;-</span> <span class="fu">assign_fixed_coords</span>(net1_t1, fixed_coord)</span>
<span id="cb103-2"><a href="one-mode-visualization.html#cb103-2" aria-hidden="true" tabindex="-1"></a>coord_t2 <span class="ot">&lt;-</span> <span class="fu">assign_fixed_coords</span>(net1_t2, fixed_coord)</span>
<span id="cb103-3"><a href="one-mode-visualization.html#cb103-3" aria-hidden="true" tabindex="-1"></a>coord_t3 <span class="ot">&lt;-</span> <span class="fu">assign_fixed_coords</span>(net1_t3, fixed_coord)</span>
<span id="cb103-4"><a href="one-mode-visualization.html#cb103-4" aria-hidden="true" tabindex="-1"></a>coord_t4 <span class="ot">&lt;-</span> <span class="fu">assign_fixed_coords</span>(net1_t4, fixed_coord)</span></code></pre></div>
<p>Now we can feed these coordinates directly into the <code>netplot_function</code> and just add new labels. Notice that we can feed these layout data frames directly in to the function, as we would a network object. This is a great functionality of <code>ggraph</code>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="one-mode-visualization.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t1) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: Pre 1980&quot;</span>)</span>
<span id="cb104-2"><a href="one-mode-visualization.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t2) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1980-1994&quot;</span>)</span>
<span id="cb104-3"><a href="one-mode-visualization.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t3) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1995-2009&quot;</span>)</span>
<span id="cb104-4"><a href="one-mode-visualization.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t4) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 2010-2024&quot;</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-48-1.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-48-2.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-48-3.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-48-4.png" width="50%" /></p>
<p>Huh, we’re <em>really</em> close, but something is not quite right yet. Even though the point have the same coordinates, each version of the network does not take up the same amount of space. For example, the subgraph for the 4th time period includes University of Kansas, which is fixed at x = -8.3, so it is one of the left-most points on the network (check out coord_t4 yourself). However, University of Kansas is not included in the subgraph for the 1st time period, and the left-most node in this network is only positioned at x = -4.7 (check out coord_t1 yourself). So our issue is that the x and y axis limits adjust based on the data we input. We can just that as one more layer, specifying the widest range of x and y values in the complete network.</p>
<p>First we can globally set these min and max axis values:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="one-mode-visualization.html#cb105-1" aria-hidden="true" tabindex="-1"></a>xmin <span class="ot">&lt;-</span> <span class="fu">min</span>(fixed_coord<span class="sc">$</span>x)</span>
<span id="cb105-2"><a href="one-mode-visualization.html#cb105-2" aria-hidden="true" tabindex="-1"></a>xmax <span class="ot">&lt;-</span> <span class="fu">max</span>(fixed_coord<span class="sc">$</span>x)</span>
<span id="cb105-3"><a href="one-mode-visualization.html#cb105-3" aria-hidden="true" tabindex="-1"></a>ymin <span class="ot">&lt;-</span> <span class="fu">min</span>(fixed_coord<span class="sc">$</span>y)</span>
<span id="cb105-4"><a href="one-mode-visualization.html#cb105-4" aria-hidden="true" tabindex="-1"></a>ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(fixed_coord<span class="sc">$</span>y)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="one-mode-visualization.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t1) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: Pre 1980&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-2"><a href="one-mode-visualization.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb106-3"><a href="one-mode-visualization.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t2) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1980-1994&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-4"><a href="one-mode-visualization.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb106-5"><a href="one-mode-visualization.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t3) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1995-2009&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-6"><a href="one-mode-visualization.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb106-7"><a href="one-mode-visualization.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t4) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 2010-2024&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="one-mode-visualization.html#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-50-1.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-50-2.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-50-3.png" width="50%" /><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-50-4.png" width="50%" /></p>
<p>For fun, we can embed these images into a gif to show how they lapse over time:</p>
<p><img src="data/animation/network.gif" width="75%" style="display: block; margin: auto;" /></p>
<details>
<summary>
<strong>Bonus code:</strong> How to create a gif from multiple plots
</summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="one-mode-visualization.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates a temporary folder</span></span>
<span id="cb107-2"><a href="one-mode-visualization.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb107-3"><a href="one-mode-visualization.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb107-4"><a href="one-mode-visualization.html#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="one-mode-visualization.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t1) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: Pre 1980&quot;</span>) <span class="sc">+</span></span>
<span id="cb107-6"><a href="one-mode-visualization.html#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb107-7"><a href="one-mode-visualization.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">&quot;data/animation/01.png&quot;</span>)))</span>
<span id="cb107-8"><a href="one-mode-visualization.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t2) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1980-1994&quot;</span>) <span class="sc">+</span></span>
<span id="cb107-9"><a href="one-mode-visualization.html#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb107-10"><a href="one-mode-visualization.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">&quot;data/animation/02.png&quot;</span>)))</span>
<span id="cb107-11"><a href="one-mode-visualization.html#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t3) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 1995-2009&quot;</span>) <span class="sc">+</span></span>
<span id="cb107-12"><a href="one-mode-visualization.html#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb107-13"><a href="one-mode-visualization.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">&quot;data/animation/03.png&quot;</span>)))</span>
<span id="cb107-14"><a href="one-mode-visualization.html#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">netplot_function</span>(coord_t4) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Collaborative network: 2010-2024&quot;</span>) <span class="sc">+</span></span>
<span id="cb107-15"><a href="one-mode-visualization.html#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(xmin,xmax)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(ymin,ymax))</span>
<span id="cb107-16"><a href="one-mode-visualization.html#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">&quot;data/animation/04.png&quot;</span>)))</span>
<span id="cb107-17"><a href="one-mode-visualization.html#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="one-mode-visualization.html#cb107-18" aria-hidden="true" tabindex="-1"></a>imgs <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">&quot;data/animation&quot;</span>), <span class="at">full.names =</span> T)</span>
<span id="cb107-19"><a href="one-mode-visualization.html#cb107-19" aria-hidden="true" tabindex="-1"></a>img_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(imgs, image_read)</span>
<span id="cb107-20"><a href="one-mode-visualization.html#cb107-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-21"><a href="one-mode-visualization.html#cb107-21" aria-hidden="true" tabindex="-1"></a>img_joined <span class="ot">&lt;-</span> <span class="fu">image_join</span>(img_list)</span>
<span id="cb107-22"><a href="one-mode-visualization.html#cb107-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-23"><a href="one-mode-visualization.html#cb107-23" aria-hidden="true" tabindex="-1"></a>img_animated <span class="ot">&lt;-</span> <span class="fu">image_animate</span>(img_joined, <span class="at">fps =</span> .<span class="dv">5</span>)</span>
<span id="cb107-24"><a href="one-mode-visualization.html#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="fu">image_write</span>(<span class="at">image =</span> img_animated,</span>
<span id="cb107-25"><a href="one-mode-visualization.html#cb107-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">path =</span> <span class="fu">here</span>(<span class="st">&quot;data/animation/network.gif&quot;</span>))</span></code></pre></div>
</details>
<p><br></p>
<p>So, <em>how have the Delta’s research collaborations changed over time?</em> In the two earliest time periods, research collaborators were densely connected, with state and federal agencies like USGS, USBR, and USFS, and the state agency, CDFW consistently at the center. In more recent years, the number of organizations involved in research has expanded to include more state and non-governmental actors, increasing in size and decreasing in density.</p>
</div>
</div>
<div id="supplemental-material-community-detection" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Supplemental Material: Community detection<a href="one-mode-visualization.html#supplemental-material-community-detection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For some bonus work, let’s combine some network statistics with visualization to take a deeper look at the network structure. This bonus material extends our first guiding question by asking: <em>Do we see any particular research communities emerge across these collaborations?</em></p>
<p>Often researchers are curious about whether or not there is some pattern within the network. Though the majority of the nodes are connected in one relatively dense component, are some organizations linking with others on a more regular basis? Is there a grouping trend in our network that we can’t see from the network figure on its own? To answer this, we might want to use some community detection approaches.</p>
<div id="algorithms-for-community-detection" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Algorithms for community detection<a href="one-mode-visualization.html#algorithms-for-community-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Broadly, community detection is an approach that employs a wide range of distance/clustering algorithms to identify to find connected communities within a network based on features like density/modularity. While we’ve moved away from <code>igraph</code>, I do want to point out that it has a number of community detection algorithms. You can read more about community detection algorithms <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6103523/">here</a>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="one-mode-visualization.html#cb108-1" aria-hidden="true" tabindex="-1"></a>?igraph<span class="sc">::</span><span class="fu">cluster_walktrap</span>() </span>
<span id="cb108-2"><a href="one-mode-visualization.html#cb108-2" aria-hidden="true" tabindex="-1"></a>?igraph<span class="sc">::</span><span class="fu">cluster_label_prop</span>()</span>
<span id="cb108-3"><a href="one-mode-visualization.html#cb108-3" aria-hidden="true" tabindex="-1"></a>?igraph<span class="sc">::</span><span class="fu">cluster_fast_greedy</span>()</span></code></pre></div>
<p>In the <code>sna</code> package there is the equivalence cluster (<code>equiv.cluster</code>) function, which identifies distances based on structural equivalence. The resource above, Hoffman et al. 2018, define it as follows: ‘Structural equivalence is an important concept from the blockmodeling literature. It is defined where two nodes play the exact same role in a network in terms of their edges, and would be considered interchangeable.’</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="one-mode-visualization.html#cb109-1" aria-hidden="true" tabindex="-1"></a>?sna<span class="sc">::</span><span class="fu">equiv.clust</span>()</span></code></pre></div>
</div>
<div id="equivalence-clusters-block-models" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Equivalence clusters &amp; block models<a href="one-mode-visualization.html#equivalence-clusters-block-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Equivalence clustering is a clustering method which groups nodes based on distance from one another. You can specify what kinds of clustering method to use with the <code>cluster.method</code> argument and what distance function to use with <code>equiv.fun</code>, but it by default uses a hierarchical clustering method based on structural equivalence using Hamming distance. We can calculate the distance and plot a dendrogram of the clusters.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="one-mode-visualization.html#cb110-1" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> <span class="fu">equiv.clust</span>(net1_noiso)</span>
<span id="cb110-2"><a href="one-mode-visualization.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ec)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-54-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now that we have these clusters, we can turn to another method, blockmodelling, which will evaluate the density of node groupings (or ‘blocks’) estimated by the equivalence clusters. We can specify how may blocks we want (<code>k</code>), or specify a height at which to split the classes (<code>h</code>). We will pick a rather arbitrary number for blocks, k = 5.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="one-mode-visualization.html#cb111-1" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">blockmodel</span>(net1_noiso, ec, <span class="at">k =</span> <span class="dv">5</span>,  <span class="at">glabels =</span> <span class="st">&quot;DSC Collaboration&quot;</span>)</span></code></pre></div>
<p>The block model output includes a vector assigning each node to a block through ‘block membership’. We can wrap this output in the <code>table</code> function to get a sense of how many nodes have been combined across the different blocks. Most of the nodes (97) are in block 1, while the remaning blocks are much smaller, and block 5 has only one node.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="one-mode-visualization.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bm<span class="sc">$</span>block.membership)</span></code></pre></div>
<pre><code>## 
##  1  2  3  4  5 
## 97  3  8  3  1</code></pre>
<p>Additionally, the block model itself provides a matrix with a density measure for the within and between block pairings. Looking along the diagonal, we see that the first block has very low density (0.03), but the smaller blocks have high within-block density (1, .89, 1), while there is no value for block 5 because the density cannot be calculated for a network of 1. <!---[CHECK: IS THIS WHAT'S HAPPENING HERE?] ---></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="one-mode-visualization.html#cb114-1" aria-hidden="true" tabindex="-1"></a>bm<span class="sc">$</span>block.model</span></code></pre></div>
<pre><code>##            Block 1   Block 2    Block 3   Block 4   Block 5
## Block 1 0.03436426 0.2852234 0.06958763 0.1718213 0.4329897
## Block 2 0.28522337 1.0000000 0.91666667 1.0000000 1.0000000
## Block 3 0.06958763 0.9166667 0.89285714 0.5000000 0.7500000
## Block 4 0.17182131 1.0000000 0.50000000 1.0000000 1.0000000
## Block 5 0.43298969 1.0000000 0.75000000 1.0000000       NaN</code></pre>
<p>We can then assign the block membership to the network. It is worth noting, however, that the vector output of <code>bm$block.membership</code> does not maintain the same node order as the nodes in our network. So we want to make sure we reorder the membership vector to align with the vertex names, which are listed under <code>bm$plabels</code>.</p>
</div>
<div id="plotting-block-membership" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Plotting block membership<a href="one-mode-visualization.html#plotting-block-membership" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="one-mode-visualization.html#cb116-1" aria-hidden="true" tabindex="-1"></a>membership <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;block&quot;</span> <span class="ot">=</span> bm<span class="sc">$</span>block.membership,</span>
<span id="cb116-2"><a href="one-mode-visualization.html#cb116-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;vertex.names&quot;</span> <span class="ot">=</span> bm<span class="sc">$</span>plabels)</span>
<span id="cb116-3"><a href="one-mode-visualization.html#cb116-3" aria-hidden="true" tabindex="-1"></a>membership <span class="ot">&lt;-</span> membership[<span class="fu">order</span>(membership<span class="sc">$</span>vertex.names),]</span>
<span id="cb116-4"><a href="one-mode-visualization.html#cb116-4" aria-hidden="true" tabindex="-1"></a>net1_noiso <span class="sc">%v%</span> <span class="st">&#39;membership&#39;</span> <span class="ot">&lt;-</span> membership<span class="sc">$</span>block</span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="one-mode-visualization.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net1_noiso, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb117-2"><a href="one-mode-visualization.html#cb117-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb117-3"><a href="one-mode-visualization.html#cb117-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree, <span class="at">color =</span> <span class="fu">factor</span>(membership)),</span>
<span id="cb117-4"><a href="one-mode-visualization.html#cb117-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb117-5"><a href="one-mode-visualization.html#cb117-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb117-6"><a href="one-mode-visualization.html#cb117-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb117-7"><a href="one-mode-visualization.html#cb117-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> labels),</span>
<span id="cb117-8"><a href="one-mode-visualization.html#cb117-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb117-9"><a href="one-mode-visualization.html#cb117-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">repel =</span> T) <span class="sc">+</span></span>
<span id="cb117-10"><a href="one-mode-visualization.html#cb117-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb117-11"><a href="one-mode-visualization.html#cb117-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Community&quot;</span>, <span class="at">size =</span> <span class="st">&quot;Degree&quot;</span>)</span></code></pre></div>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Let’s rethink our labels to get a better sense of who is in what group</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="one-mode-visualization.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Like before, set a conditional statement so that we only have labels</span></span>
<span id="cb118-2"><a href="one-mode-visualization.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for nodes whose membership is in the dense nodes</span></span>
<span id="cb118-3"><a href="one-mode-visualization.html#cb118-3" aria-hidden="true" tabindex="-1"></a>net1_noiso <span class="sc">%v%</span> <span class="st">&#39;member_label&#39;</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(net1_noiso <span class="sc">%v%</span> <span class="st">&#39;membership&#39;</span> <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb118-4"><a href="one-mode-visualization.html#cb118-4" aria-hidden="true" tabindex="-1"></a>                                        net1_noiso <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span>, <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We might also want to make a table of those so we can check it out</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="one-mode-visualization.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&#39;block&#39;</span> <span class="ot">=</span> </span>
<span id="cb119-2"><a href="one-mode-visualization.html#cb119-2" aria-hidden="true" tabindex="-1"></a>             (net1_noiso <span class="sc">%v%</span> <span class="st">&#39;membership&#39;</span>)[net1_noiso <span class="sc">%v%</span> <span class="st">&#39;membership&#39;</span> <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb119-3"><a href="one-mode-visualization.html#cb119-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">&#39;name&#39;</span> <span class="ot">=</span> (net1_noiso <span class="sc">%v%</span> <span class="st">&#39;name&#39;</span>)[net1_noiso <span class="sc">%v%</span> <span class="st">&#39;membership&#39;</span> <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb119-4"><a href="one-mode-visualization.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(block)</span></code></pre></div>
<pre><code>##    block                                              name
## 1      2                                              CDFW
## 2      2                                              USBR
## 3      2                                             USFWS
## 4      3                                               DWR
## 5      3                                            CalEPA
## 6      3                                             SWRCB
## 7      3 Delta Stewardship Council - Delta Science Program
## 8      3                                               DFG
## 9      3             East Bay Municipal Utilities District
## 10     3                                              NMFS
## 11     3                                             USACE
## 12     4                                              NOAA
## 13     4                                              USDA
## 14     4                                             USEPA
## 15     5                                              USGS</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="one-mode-visualization.html#cb121-1" aria-hidden="true" tabindex="-1"></a>iso_net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net1_noiso, <span class="at">layout =</span> <span class="st">&#39;fr&#39;</span>) <span class="sc">+</span></span>
<span id="cb121-2"><a href="one-mode-visualization.html#cb121-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_edge_link</span>(<span class="at">color =</span> <span class="st">&quot;gray80&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-3"><a href="one-mode-visualization.html#cb121-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> degree, <span class="at">color =</span> <span class="fu">factor</span>(membership)),</span>
<span id="cb121-4"><a href="one-mode-visualization.html#cb121-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb121-5"><a href="one-mode-visualization.html#cb121-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb121-6"><a href="one-mode-visualization.html#cb121-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Delta Science Collaborative Research Network&quot;</span>) <span class="sc">+</span></span>
<span id="cb121-7"><a href="one-mode-visualization.html#cb121-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> member_label),</span>
<span id="cb121-8"><a href="one-mode-visualization.html#cb121-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb121-9"><a href="one-mode-visualization.html#cb121-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">repel =</span> T) <span class="sc">+</span></span>
<span id="cb121-10"><a href="one-mode-visualization.html#cb121-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb121-11"><a href="one-mode-visualization.html#cb121-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Community&quot;</span>, <span class="at">size =</span> <span class="st">&quot;Degree&quot;</span>)</span>
<span id="cb121-12"><a href="one-mode-visualization.html#cb121-12" aria-hidden="true" tabindex="-1"></a>iso_net</span></code></pre></div>
<pre><code>## Warning: ggrepel: 3 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And what if I want to clean this up, say, have only one legend and move the legend below. We can specify which legends we want with <code>guides()</code> and put the legend in the ‘bottom’ position with <code>themes()</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="one-mode-visualization.html#cb123-1" aria-hidden="true" tabindex="-1"></a>iso_net <span class="sc">+</span></span>
<span id="cb123-2"><a href="one-mode-visualization.html#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Community&quot;</span>, <span class="at">size =</span> <span class="st">&quot;Degree&quot;</span>) <span class="sc">+</span> </span>
<span id="cb123-3"><a href="one-mode-visualization.html#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;legend&quot;</span>, <span class="at">size =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb123-4"><a href="one-mode-visualization.html#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: ggrepel: 3 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="04_onemode_visualization_files/figure-html/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To conclude this section we can revisit the question we set out in this supplemental code: <em>Do we see any particular research communities emerge across these collaborations?</em></p>
<p>We’ve used the <code>blockmodel</code> function, paired with more conditional assignments of network attributes to identify some possible research clusters. Among our five ‘blocks’ we see high density among three of them: blocks 2, 3, and 4. Block 2 includes three of the most central nodes – CDFW, USBR, USFWS – suggesting that these three wild-life and land use agencies at the state and federal levels repeatedly collaborate together in the Delta. Block 3 includes a wider variety of state agencies that are closely clustered. And block 4 has only three federal agencies, USDA, EPA, and NOAA, who much like block 2 seem to be consistently collaborating on science projects. Block 5 includes only USGS, the network’s most central node, pointing to the challenge of clustering highly central nodes given that they span so many connections. The remainder of the organizations are grouped into Block 1, a low-density mass that have no clear trend towards clustering.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-network-objects-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-mode-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_network_viz/edit/master/04_onemode_visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_network_viz/blob/master/04_onemode_visualization.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
